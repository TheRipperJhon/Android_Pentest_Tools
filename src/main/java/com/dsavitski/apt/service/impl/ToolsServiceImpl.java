package com.dsavitski.apt.service.impl;

import com.dsavitski.apt.service.CmdService;
import com.dsavitski.apt.service.ConfigService;
import com.dsavitski.apt.service.ToolsService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import static com.dsavitski.apt.constants.ConfigKeys.APT_PATH;
import static com.dsavitski.apt.constants.ConfigKeys.BURP_INTERFACE;
import static com.dsavitski.apt.constants.ScriptConstants.BURPSUITE_CERTIFICATE_PATH;
import static com.dsavitski.apt.constants.ScriptConstants.BURPSUITE_PULL_CERT_SCRIPT;

@Service
public class ToolsServiceImpl implements ToolsService {
    @Autowired
    private CmdService cmdService;
    @Autowired
    private ConfigService configService;

    @Override
    public void pullBurpCertificate() {
        final String burpInterface = configService.getByKey(BURP_INTERFACE);
        final String aptPath = configService.getByKey(APT_PATH);
        cmdService.executeScript(BURPSUITE_PULL_CERT_SCRIPT, burpInterface, aptPath + BURPSUITE_CERTIFICATE_PATH);
    }
}
