package com.dsavitski.apt.controllers;

import com.dsavitski.apt.service.ConfigService;
import com.dsavitski.apt.service.ToolsService;
import javafx.fxml.FXML;
import javafx.scene.control.TextField;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;

import static com.dsavitski.apt.constants.ConfigKeys.*;

@Controller
public class SettingsController {
    @Autowired
    private ConfigService configService;
    @Autowired
    private ToolsService toolsService;

    @FXML
    private TextField settingsBurpInterface;
    @FXML
    private TextField settingsAptPath;
    @FXML
    private TextField settingsLocalIp;

    @FXML
    public void initialize() {
        String burpInterface = configService.getByKey(BURP_INTERFACE);
        if (burpInterface != null) {
            settingsBurpInterface.setText(burpInterface);
        }

        String aptPath = configService.getByKey(APT_PATH);
        if (aptPath != null) {
            settingsAptPath.setText(aptPath);
        }

        String localIp = configService.getByKey(LOCAL_IP);
        if (localIp != null) {
            settingsLocalIp.setText(localIp);
        }
    }

    public void saveSettings() {
        configService.saveOption(BURP_INTERFACE, settingsBurpInterface.getText());
        configService.saveOption(APT_PATH, settingsAptPath.getText());
        configService.saveOption(LOCAL_IP, settingsLocalIp.getText());
    }

    public void pullBurpCertificate() {
        toolsService.pullBurpCertificate();
    }
}
