package com.dsavitski.apt.controllers;

import com.dsavitski.apt.service.ConfigService;
import javafx.fxml.FXML;
import javafx.scene.control.TextField;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;

import static com.dsavitski.apt.constants.ConfigKeys.APT_PATH;
import static com.dsavitski.apt.constants.ConfigKeys.SESSION_DIR;

@Controller
public class SettingsController {
    private static final Logger logger = LogManager.getLogger(SettingsController.class);

    @Autowired
    private ConfigService configService;

    @FXML
    private TextField settingsAptPath;
    @FXML
    private TextField settingsSessionDir;

    @FXML
    public void initialize() {
        String aptPath = configService.getByKey(APT_PATH);
        if (aptPath != null) {
            settingsAptPath.setText(aptPath);
        }

        String sessionDir = configService.getByKey(SESSION_DIR);
        if (sessionDir != null) {
            settingsSessionDir.setText(sessionDir);
        }
    }

    @FXML
    public void saveSettings() {
        configService.saveOption(APT_PATH, settingsAptPath.getText());
        configService.saveOption(SESSION_DIR, settingsSessionDir.getText());
        logger.info("Settings saved");
    }
}
