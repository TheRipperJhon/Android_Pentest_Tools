#!/bin/bash
unpacked_app_path=$1
checksec_path=$2

# launch in a separate terminal window
if [ ! -t 1 ]; then
    gnome-terminal -x bash -c "$0 $unpacked_app_path $checksec_path;bash"
    exit
fi

cd $unpacked_app_path

echo "checksec.sh (Version : 1.5):"
echo "RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      FILE"
find -iname '*.so' | xargs -i $checksec_path --file {} | grep -v 'FILE'

